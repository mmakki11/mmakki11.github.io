<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Begin Jekyll SEO tag v2.4.0 -->
    <title>LAB 6</title>
    <meta name="generator" content="Jekyll v3.7.3" />
    <meta property="og:title" content="Mahdi Makki, Hunter College" />
    <meta property="og:locale" content="en_US" />
    <link rel="canonical" href="https://mmakki11.github.io/" />
    <meta property="og:url" content="https://mmakki11.github.io/" />
    <meta property="og:site_name" content="mmakki11.github.io" />
    <script type="application/ld+json">
      {
        "name": "mmakki11.github.io",
        "@type": "WebSite",
        "url": "https://mmakki11.github.io/",
        "headline": "Mahdi Makki, Hunter College",
        "@context": "http://schema.org"
      }
    </script>
    <!-- End Jekyll SEO tag -->

    <link
      href="https://fonts.googleapis.com/css?family=Poppins:400"
      rel="stylesheet"
    />

    <!-- MathJax -->
    <script
      type="text/javascript"
      async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"
    ></script>

    <!--   <link crossorigin="anonymous" media="all" integrity="sha512-Z0JAar9+DkI1NjGVdZr3GivARUgJtA0o2eHlTv7Ou2gshR5awWVf8QGsq11Ns9ZxQLEs+G5/SuARmvpOLMzulw==" rel="stylesheet" href="https://assets-cdn.github.com/assets/frameworks-95aff0b550d3fe338b645a4deebdcb1b.css" />
    -->
    <!--   <link crossorigin="anonymous" media="all" integrity="sha512-yv+kWn8ewbavFKfvLZifQplJ0chJ6H894rDwGVvn0LtaG80VxAQmPt8pRMMOSlGNSiPwZEDSVzZjyOOiVe0eyA==" rel="stylesheet" href="https://assets-cdn.github.com/assets/github-37504d684728c80db863d719b4ac6781.css" />
    -->
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      <style>
        table {
          border-collapse: collapse;
        }
        table,
        td,
        th {
          text-align: left;
          padding: 8px;
          padding-bottom: 6px;
          border: 1px solid #dee1e4;
        }
        tr:nth-child(even) {
          background-color: #fafafa;
        }
        tr:nth-child(odd) {
          background-color: #ffffff;
        }
        hr.style-six {
          border: 0;
          height: 0;
          border-top: 1px solid rgba(0, 0, 0, 0.1);
          border-bottom: 1px solid rgba(255, 255, 255, 0.3);
        }
        a:link {
          text-decoration: none;
        }
        a:visited {
          text-decoration: none;
          color: blue;
        }
        a:hover {
          text-decoration: none;
        }
        a:active {
          text-decoration: none;
        }
      </style>

      <h2 id="lab-6">LAB 6</h2>

      <p>
        Today’s lab will focus on accessing formatted data using Pandas and Unix
        shell scripts.
      </p>

      <p>
        Software tools needed: web browser and Python IDLE programming
        environment with the Pandas package installed.
      </p>

      <h3 id="in-class-quiz">In-class Quiz</h3>

      <p>
        During lab, there is a <a href="quizzes.html">quiz</a>. The password to
        access the quiz will be given during lab. To complete the quiz, log on
        to Blackboard (see <a href="lab1.html">Lab 1</a> for details on using
        Blackboard).
      </p>

      <h3 id="using-python-gradescope-and-blackboard">
        Using Python, Gradescope, and Blackboard
      </h3>

      <p>
        See <a href="lab_01.html">Lab 1</a> for details on using Python,
        Gradescope, and Blackboard.
      </p>

      <h3 id="pandas--reading-data">Pandas &amp; Reading Data</h3>

      <p>
        To make reading files easier, we will use the Pandas library that lets
        you read in structured data files very efficiently.
        <a href="http://pandas.pydata.org"
          ><code class="language-plaintext highlighter-rouge">Pandas</code></a
        >, Python Data Analysis Library, is an elegant, open-source package for
        extracting, manipulating, and analyzing data, especially those stored in
        2D arrays (like spreadsheets). It incorporates most of the Python
        constructs and libraries that we have seen thus far.
      </p>

      <p>
        (<code class="language-plaintext highlighter-rouge">Pandas</code> is
        installed with anaconda<a href="lab1.html">Lab 1</a> for
        installing packages for Python.)
      </p>

      <p>
        In <code class="language-plaintext highlighter-rouge">Pandas</code>, the
        basic structure is a DataFrame which stored data in rectangular grids.
        Let’s use this to visualize the change in New York City’s population.
        First, start your file with an import statements for pyplot and pandas:
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre class="highlight"><code>import matplotlib.pyplot as plt
import pandas as pd
</code></pre>
        </div>
      </div>

      <p>
        We used matplotlib in the <a href="lab_03.html">Lab 3</a> and
        <a href="lab_04.html">Lab 4</a> for plotting. The as plt allows us to
        use the plotting commands without having to write matplotlib.pyplot
        everytime, instead we just write plt. Similarly, The as pd allows us to
        use pandas commands without writing out pandas everytime– we just write
        pd.
      </p>

      <p>
        Next, save the
        <a href="images/nycHistPop.csv">NYC historical population data</a> to
        the same directory as your program. This is a “comma separated values”
        file– which is a plain text file containging spreadsheet data, with
        commas separating the different columns (thus, the name). Here’s the
        first 10 lines of the file:
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre
            class="highlight"
          ><code>Source:  https://en.wikipedia.org/wiki/Demographics\_of\_New\_York\_City,,,,,,
\* All population figures are consistent with present-day boundaries.,,,,,,
First census after the consolidation of the five boroughs,,,,,,
,,,,,,
,,,,,,
Year,Manhattan,Brooklyn,Queens,Bronx,Staten Island,Total
1698,4937,2017,,,727,7681
1771,21863,3623,,,2847,28423
1790,33131,4549,6159,1781,3827,49447
1800,60515,5740,6642,1755,4563,79215
</code></pre>
        </div>
      </div>

      <p>
        Note that it has 5 extra lines at the top before the column names occur.
        The pandas function for reading in CSV files is read_csv(). It has an
        option to skip rows which we will use here:
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre
            class="highlight"
          ><code>pop = pd.read_csv('nycHistPop.csv',skiprows=5)
</code></pre>
        </div>
      </div>

      <p>
        Before going on, let’s print out the variable pop. pop is a dataframe,
        described in the reading above:
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre class="highlight"><code>print(pop)
</code></pre>
        </div>
      </div>

      <p>The last line of our first pandas program is:</p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre class="highlight"><code>pop.plot(x="Year")
</code></pre>
        </div>
      </div>

      <p>
        which makes a graphical display of all of the data series in the
        variable pop with the series corresponding to the column “Year” as the
        x-axis. Your output should look something like:
      </p>

      <p><img src="images/nycHist.png" alt="" /></p>

      <p>To recap: our program is:</p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre class="highlight"><code>import matplotlib.pyplot as plt

import pandas as pd
pop = pd.read_csv('nycHistPop.csv',skiprows=5)
pop.plot(x="Year")

plt.show()
</code></pre>
        </div>
      </div>

      <p>which did the following:</p>

      <ul>
        <li>
          Imported the pandas library that contains structures and functions for
          organizing and visualizing data. We also imported the pyplot library
          which pandas uses to create figures.
        </li>
        <li>
          It read in a CSV file, containing NYC population historical data.
        </li>
        <li>
          It displayed the data as a visual plot of years versus borough
          populations.
        </li>
        <li>
          The last line shows the figure you created in a separate graphics
          window.
        </li>
      </ul>

      <p>
        There are useful built-in statistics functions for the dataframes in
        pandas. For example, if you would like to know the maximum value for the
        series “Bronx”, you apply the
        <code class="language-plaintext highlighter-rouge">max()</code> function
        to that series:
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre
            class="highlight"
          ><code>print("The largest number living in the Bronx is", pop["Bronx"].max()) 
</code></pre>
        </div>
      </div>

      <p>Similarly the average (mean) population for Queens can be computed:</p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre
            class="highlight"
          ><code>print("The average number living in the Queens is", pop["Queens"].mean()) 
</code></pre>
        </div>
      </div>

      <h4 id="challenges">Challenges</h4>

      <ul>
        <li>What happens if you leave off the x = “Year”? Why?</li>
        <li>What happens if you add in x = “Year”, y = “Bronx”?</li>
        <li>
          What does the series functions: .min(), .std(), and .count() do?
        </li>
      </ul>

      <h3 id="manipulating-columns">Manipulating Columns</h3>

      <p>
        Each column in the original spreadsheet is a column, or series. We can
        look at the column for the Bronx with:
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre class="highlight"><code>print(pop['Bronx'])
</code></pre>
        </div>
      </div>

      <p>How would you look at the one for Brooklyn?</p>

      <p>
        A nice thing about series is that you can do basic arithmetic with them.
        For example,
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre class="highlight"><code>print(pop['Bronx']*2)
</code></pre>
        </div>
      </div>

      <p>prints out double the values in the column.</p>

      <p>You can also use multiple columns in a calculation:</p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre class="highlight"><code>print(pop['Bronx']/pop['Total'])
</code></pre>
        </div>
      </div>

      <p>
        prints out the fraction of the total population that lives in the Bronx.
      </p>

      <p>We can save that series by creating a new column for it:</p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre
            class="highlight"
          ><code>pop['Fraction'] = pop['Bronx']/pop['Total']
</code></pre>
        </div>
      </div>

      <p>and then can use it to create a new graph:</p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre class="highlight"><code>pop.plot(x = 'Year', y = 'Fraction')
</code></pre>
        </div>
      </div>

      <p>
        We can save it to a file, by storing the current figure (via “get
        current figure” or
        <code class="language-plaintext highlighter-rouge">gcf()</code> function
        and then saving it:
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre class="highlight"><code>fig = plt.gcf()
fig.savefig('fractionBX.png')
</code></pre>
        </div>
      </div>

      <p>
        shown in the following plot:<br />
        <img src="images/bronxFraction.png" alt="" />
      </p>

      <p>Putting this altogether, we have a program:</p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre
            class="highlight"
          ><code>#Libraries for plotting and data processing:
import matplotlib.pyplot as plt
import pandas as pd

#Open the CSV file and store in pop
pop = pd.read_csv('nycHistPop.csv',skiprows=5)

#Compute the fraction of the population in the Bronx, and save as new column:
pop['Fraction'] = pop['Bronx']/pop['Total']

#Create a plot of year versus fraction of pop. in Bronx (with labels):
pop.plot(x = 'Year', y = 'Fraction')

#Save to the file:  fractionBX.png
fig = plt.gcf()
fig.savefig('fractionBX.png)
</code></pre>
        </div>
      </div>

      <p>
        How can you modify the program to let the user specify the borough to
        compute the fraction of the population? When you have the answer, see
        the <a href="assignments.html">Programming Problem List</a>.
      </p>

      <h3 id="more-on-the-command-line-interface">
        More on the Command Line Interface
      </h3>

      <p>
        You can write programs in the Unix shell scripting language. Often
        called
        <code class="language-plaintext highlighter-rouge">_scripts_</code>,
        they are typically used for tying together input and output from
        different programs.
      </p>

      <p>
        Let’s look at a sample script (from
        <a href="https://www.panix.com/~elflord/unix/bash-tute.html"
          >elf lord’s tutorials on linux</a
        >):
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre class="highlight"><code>#!/bin/bash
echo "hello, $USER. I wish to list some files of yours"
echo "listing files in the current directory, $PWD"
ls  # list files
</code></pre>
        </div>
      </div>

      <p>Looking at this script line-by-line:</p>

      <ul>
        <li>
          <p>
            <code class="language-plaintext highlighter-rouge"
              >#!/bin/bash</code
            >
          </p>

          <p>
            It’s standard to include as the first line of your scripts that
            specifies the program that’s running (this is often called the
            “shebang” line). There’s different variants of shell scripts. We’re
            using the default for Ubuntu (the type of Unix running on the lab
            laptops, called bash, so, we start our script by specifying that we
            want to use the bash shell to evaluate it.
          </p>
        </li>
        <li>
          <p>
            The command
            <code class="language-plaintext highlighter-rouge">echo</code> is
            similar to
            <code class="language-plaintext highlighter-rouge">print()</code> in
            Python. It writes a message to the terminal:
          </p>

          <div class="language-plaintext highlighter-rouge">
            <div class="highlight">
              <pre
                class="highlight"
              ><code>echo "hello, $USER. I wish to list some files of yours"
echo "listing files in the current directory, $PWD"
</code></pre>
            </div>
          </div>

          <p>
            <code class="language-plaintext highlighter-rouge">$USER</code> is a
            built-in variable that store the name of the current user.
            Similarly, the built-in variable, $PWD, stores the current directory
            (folder) that you are in.
          </p>
        </li>
        <li>
          <p>
            (NOTE: $USER might not print anything on gitbash installed on windows)
            Lastly, our scripts can include any of the Unix commands that you
            have already learned. The last line of this file lists the files in
            the current directory using the ls command:
          </p>

          <div class="language-plaintext highlighter-rouge">
            <div class="highlight">
              <pre class="highlight"><code>ls  # list files
</code></pre>
            </div>
          </div>

          <p>
            In the shell, the different types of quotes have similar, but
            different,
            <a
              href="https://www.gnu.org/software/bash/manual/html_node/Double-Quotes.html"
              >meanings</a
            >. We’ll use the double quotes since strings in double quotes will
            have special characters (like
            <code class="language-plaintext highlighter-rouge">\n</code> for
            newline) interpreted as in Python and C++.
          </p>

          <p>
            Use the 'nano' command to save the above script as "helloScript.sh" from your terminal:
            Type:
            <code class="language-plaintext highlighter-rouge">nano helloScript.sh</code>
            Once the file is open copy the above script into the nano editor which opened up.
            , after you are done click 'cntrl+X' on your keyboard followed by 'Y' in order to save the changes 
            of the file you created locally
          </p>

          <p>
            Next, we’ll change the permissions on the file, so that we can run
            it directly, by just typing its name:
          </p>

          <div class="language-plaintext highlighter-rouge">
            <div class="highlight">
              <pre class="highlight"><code>chmod +x helloScript.sh
</code></pre>
            </div>
          </div>

          <p>
            (changes the “mode” of the file helloScript to be executable– if you
            name it something else, replace the name in chmod command above).*
            To run your first shell script, you can now type its name at the
            terminal:
          </p>

          <div class="language-plaintext highlighter-rouge">
            <div class="highlight">
              <pre class="highlight"><code>./helloScript.sh
</code></pre>
            </div>
          </div>

          <p>
            <a href="assignments.html">Programming Problem List</a>.
          </p>
        </li>
      </ul>

      <h3 id="whats-next">What’s Next?</h3>

      <p>
        If you finish the lab early, now is a great time to get a head start on
        the programming problems due early next week. There’s instructors to
        help you, and you already have Python up and running. The
        <a href="assignments.html">Programming Problem List</a> has problem
        descriptions, suggested reading, and due dates next to each problem.
      </p>
    </div>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js"
      integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg="
      crossorigin="anonymous"
    ></script>
    <script>
      anchors.add();
    </script>
  </body>
</html>
