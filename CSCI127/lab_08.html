<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Begin Jekyll SEO tag v2.4.0 -->
    <title>LAB 8</title>
    <meta name="generator" content="Jekyll v3.7.3" />
    <meta property="og:title" content="Mahdi Makki, Hunter College" />
    <meta property="og:locale" content="en_US" />
    <link rel="canonical" href="https://mmakki11.github.io/" />
    <meta property="og:url" content="https://mmakki11.github.io/" />
    <meta property="og:site_name" content="mmakki11.github.io" />
    <script type="application/ld+json">
      {
        "name": "mmakki11.github.io",
        "@type": "WebSite",
        "url": "https://mmakki11.github.io/",
        "headline": "Mahdi Makki, Hunter College",
        "@context": "http://schema.org"
      }
    </script>
    <!-- End Jekyll SEO tag -->

    <link
      href="https://fonts.googleapis.com/css?family=Poppins:400"
      rel="stylesheet"
    />

    <!-- MathJax -->
    <script
      type="text/javascript"
      async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"
    ></script>

    <!--   <link crossorigin="anonymous" media="all" integrity="sha512-Z0JAar9+DkI1NjGVdZr3GivARUgJtA0o2eHlTv7Ou2gshR5awWVf8QGsq11Ns9ZxQLEs+G5/SuARmvpOLMzulw==" rel="stylesheet" href="https://assets-cdn.github.com/assets/frameworks-95aff0b550d3fe338b645a4deebdcb1b.css" />
    -->
    <!--   <link crossorigin="anonymous" media="all" integrity="sha512-yv+kWn8ewbavFKfvLZifQplJ0chJ6H894rDwGVvn0LtaG80VxAQmPt8pRMMOSlGNSiPwZEDSVzZjyOOiVe0eyA==" rel="stylesheet" href="https://assets-cdn.github.com/assets/github-37504d684728c80db863d719b4ac6781.css" />
    -->
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      <style>
        table {
          border-collapse: collapse;
        }
        table,
        td,
        th {
          text-align: left;
          padding: 8px;
          padding-bottom: 6px;
          border: 1px solid #dee1e4;
        }
        tr:nth-child(even) {
          background-color: #fafafa;
        }
        tr:nth-child(odd) {
          background-color: #ffffff;
        }
        hr.style-six {
          border: 0;
          height: 0;
          border-top: 1px solid rgba(0, 0, 0, 0.1);
          border-bottom: 1px solid rgba(255, 255, 255, 0.3);
        }
        a:link {
          text-decoration: none;
        }
        a:visited {
          text-decoration: none;
          color: blue;
        }
        a:hover {
          text-decoration: none;
        }
        a:active {
          text-decoration: none;
        }
      </style>

      <h2 id="lab-8">LAB 8</h2>

      <p>
        Today’s lab will focus on mapping data, using pandas, numpy,
        and using Python from the command line.
      </p>

      <p>
        Software tools needed: web browser and Python IDLE programming
        environment with the pandas and matplotlib packages installed.
      </p>

      <h3 id="in-class-quiz">In-class Quiz</h3>

      <p>
        During lab, there is a <a href="quizzes.html">quiz</a>. The password to
        access the quiz will be given during lab. To complete the quiz, log on
        to Blackboard (see <a href="lab_01.html">Lab 1</a> for details on using
        Blackboard).
      </p>

      <h3 id="using-python-gradescope-and-blackboard">
        Using Python, Gradescope, and Blackboard
      </h3>

      <p>
        See <a href="lab_01.html">Lab 1</a> for details on using Python,
        Gradescope, and Blackboard.
      </p>

      <h3 id="binning-data-parking-tickets">Binning Data: Parking Tickets</h3>

      <p>
        <a href="https://data.cityofnewyork.us"
          ><img src="images/openDataLogo.png" alt=""
        /></a>
      </p>

      <p>
        Via the
        <a href="https://data.cityofnewyork.us">NYC Open Data</a> project, you
        can access data from almost every city agency. Today, we will look at
        the parking tickets issues by New York City. We will use a small version
        (1000 lines) for today’s lab (see below). But you are welcome to use any
        neighborhood in the city. To download data for a given neighborhood (and
        restricted to just fiscal year 2018, since the data sets can be quite
        large):
      </p>

      <ul>
        <li>
          Instead of neighborhood name or zipcode, parking tickets are
          classified by the police precinct that issued the ticket. First,
          figure out the precinct (here’s a
          <a
            href="http://www1.nyc.gov/site/nypd/bureaus/patrol/find-your-precinct.page"
            >useful tool</a
          >).
        </li>
        <li>
          <a
            href="https://data.cityofnewyork.us/City-Government/Parking-Violations-Issued-Fiscal-Year-2018/pvqr-7yc4/data"
            >Fiscal year 2018 (FY2018) parking tickets</a
          >
          for your precinct: download the data set as a CSV, filtering by
          “Violation Precinct”. For example, Hunter College is located in the
          19th Precinct, so, you would enter 19 on the filter.
        </li>
      </ul>

      <p>
        A simple, but very powerful, technique is “binning data”– that is
        grouping data into the number of occurrences for each categories. The
        category values can often show patterns that individual data points do
        not. For example, binning population by zipcode can show patterns in
        density that’s difficult to see with individual data points.
      </p>

      <h3 id="csv-data-files">CSV Data Files</h3>

      <p>
        CSV files store tabular information in readable text files. The files
        downloaded above have information separated by commas (using tabs as
        delimiters is also common). Here is a sample line:
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre
            class="highlight"
          ><code>1335632335,L040HZ,FL,PAS,06/09/2015,46,SUBN,NISSA,X,35430,
14510,15710,0,0020,20,74,921167,E074,0000,1213P,1207P,NY,
O,4,WEST 83 ST,,0,408,C,,BBBBBBB,ALL,ALL,RED,0,0,-,0,,,,,
</code></pre>
        </div>
      </div>

      <p>
        All lines are formatted similarly: they start with the summons number,
        then the license plate, registration state, plate Type, date, and
        continue with the information about the location and type of violation,
        and sometimes additional information such as the who issued the ticket
        and the color of the car. The first line of the file gives the entries
        in the order they occur in the rows.
      </p>

      <p>
        The sample entry above gives details for a ticket issues on June 9, 2015
        to a passenger car with Florida plates, L040HZ. The red Nissan SUV
        received the ticket on West 83rd Street. Each entry also begins with a
        unique identifier that can be used to look up the parking ticket.
      </p>

      <p>
        Since there were over 196,000 tickets for the FY 2016 for the 20th
        precinct, the file for today’s classwork is the first 1000 lines:
        <a href="images/tickets.csv">tickets.csv</a>.
      </p>

      <p>Here are some questions we can ask about the data:</p>

      <ul>
        <li>Which car got the most tickets?</li>
        <li>What color of car is most likely to get a ticket?</li>
        <li>What type of license gets the most tickets?</li>
        <li>Which location yields the most tickets?</li>
      </ul>

      <p>
        For each of these questions, we can traverse the file and count the
        occurrences as we go.
      </p>

      <h3 id="counting-tickets-per-car">Counting Tickets per Car</h3>

      <p>
        How can tell which car got the most tickets? First, we need to figure
        out a unique way to identify different cars. Luckily, cars almost always
        have license plates– with each state having a unique number. (For this
        simple exercise, we’ll assume that each license plate is unique on its
        own– not an unreasonable assumption since every state has a different
        schema for assigning numbers, but to be more accurate we should keep
        track of license plate number and issuing state.)
      </p>

      <p>
        Open up the CSV file and look at the columns. Which column contains the
        license plate number? Here’s all the column names (first line of
        <a href="images/tickets.csv">tickets.csv</a>):
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre
            class="highlight"
          ><code>Summons Number,Plate ID,Registration State,Plate Type,Issue Date,
Violation Code,Vehicle Body Type,Vehicle Make,Issuing Agency,
Street Code1,Street Code2,Street Code3,Vehicle Expiration Date,
Violation Location,Violation Precinct,Issuer Precinct,Issuer Code,
Issuer Command,Issuer Squad,Violation Time,Time First Observed,
Violation County,Violation In Front Of Or Opposite,House Number,
Street Name,Intersecting Street,Date First Observed,Law Section,
Sub Division,Violation Legal Code,Days Parking In Effect,From Hours 
In Effect,To Hours In Effect,Vehicle Color,Unregistered Vehicle?,
Vehicle Year,Meter Number,Feet From Curb,Violation Post Code,
Violation Description,No Standing or Stopping Violation,Hydrant 
Violation,Double Parking Violation
</code></pre>
        </div>
      </div>

      <p>
        It’s the second column: Plate ID. Scanning the CSV file, it looks like
        most cars got one or two tickets. How can we get the worst offenders
        (i.e. those cars that got the most parking tickets)?
      </p>

      <p>
        Let’s use
        <code class="language-plaintext highlighter-rouge">Pandas</code> to read
        in the CSV file, following the same pattern as last lab:
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre class="highlight"><code>#CSci 127 Teaching Staff
#October 2017
#Count which cars got the most parking tickets

#Import pandas for reading and analyzing CSV data:
import pandas as pd

csvFile = "tickets.csv"			#Name of the CSV file
tickets = pd.read_csv(csvFile)		#Read in the file to a dataframe
print(tickets) 				#Print out the dataframe
</code></pre>
        </div>
      </div>

      <p>
        Run your program. That printed out all the information about all the
        tickets issued. Let’s focus in on just licence plates. Change the last
        line of your program to be:
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre
            class="highlight"
          ><code>print(tickets["Plate ID"])	#Print out licence plates 
</code></pre>
        </div>
      </div>

      <p>
        When you run the program again, you should just see the row number and
        licence plates.
      </p>

      <p>
        We want to refine this further to print how many tickets each car got.
        Pandas has a function just for counting occurrences, called
        <code class="language-plaintext highlighter-rouge">value_counts()</code
        >. Let’s modify our last line again to use it:
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre
            class="highlight"
          ><code>print(tickets["Plate ID"].value_counts())	#Print out plates &amp; number of tickets each got
</code></pre>
        </div>
      </div>

      <p>
        Rerunning the program, there are a lot of cars that got only a single
        ticket. If you scroll back up the Python shell, you will see the cars
        with the most tickets are listed first. Let’s just print out the 10 cars
        that got the most tickets. We can do this by slicing to [:10]:
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre
            class="highlight"
          ><code>print(tickets["Plate ID"].value_counts()[:10])	#Print 10 worst &amp; number of tickets 
</code></pre>
        </div>
      </div>

      <p>
        Even with only 1000 lines of ticket information, there is a car (with
        plate “TOPHAT5”) that got more than 5 tickets.
      </p>

      <p>
        Let’s make our program a bit more general, to allow the user to enter
        their own file name:
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre class="highlight"><code>#CSci 127 Teaching Staff
#October 2017
#Count which cars got the most parking tickets

#Import pandas for reading and analyzing CSV data:
import pandas as pd

csvFile = input('Enter CSV file name: ')         #Name of the CSV file
tickets = pd.read_csv(csvFile)     #Read in the file to a dataframe
print("The 10 worst offenders are:")
print(tickets["Plate ID"].value_counts()[:10]) #Print out the dataframe
</code></pre>
        </div>
      </div>

      <p>
        And run it on all tickets for the 20th precinct for January 2016 (14,000
        tickets):
        <a href="images/Parking_Violations_Jan_2016.csv"
          >Parking_Violations_Jan_2016.csv</a
        >.
      </p>

      <p>You should see output:</p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre
            class="highlight"
          ><code>Enter CSV file name: Parking\_Violations\_Jan_2016.csv
The 10 worst offenders are:
63044JM    52
63277JM    46
63540JM    42
93503JT    36
42816JM    35
97223JE    35
62150JM    35
31420MG    32
23246MA    31
AP113R     30
Name: Plate ID, dtype: int64
</code></pre>
        </div>
      </div>

      <p>
        For just the month of January 2016, there were 9 cars that got more than
        a ticket a day.
      </p>

      <h4 id="binning-other-data">Binning Other Data</h4>

      <p>
        Now that you have a program to use as a basic template, answer the
        following questions:
      </p>

      <ul>
        <li>What color of car is most likely to get a ticket?</li>
        <li>What type of license gets the most tickets?</li>
        <li>Which location yields the most tickets?</li>
      </ul>

      <p>
        (Remember to check the CSV file for the name used for the columns and
        use that as the index.)
      </p>

      <h3 id="top-down-design">Top Down Design</h3>

      <p>
        Functions are used to design programs and provide an elegant way to
        divide work among several programmers. A standard technique, called
        <strong>top-down design</strong>, consists of breaking a program into
        multiple function calls (covered in more detail in Chapter 8). Each
        function is written separately and then tested, before the next function
        is written.
      </p>

      <p><img src="images/herd.png" alt="" /></p>

      <p>
        In today’s lab, we will write a program to draw images using turtles. We
        will focus on breaking down the problem into functions, and then
        implementing (and testing!) each function separately. Here’s a basic
        outline of our program:
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre
            class="highlight"
          ><code>#Intro Programming Lab:  A program with a herd of turtles

import turtle

def main():
    welcomeMessage()            #Writes a welcome message to the shell
    numTurtles = getInput()     #Ask for number of turles
    w = setUpScreen()           #Set up a green turtle window
    turtleList = setUpTurtles(numTurtles) #Make a list of turtles, different colors
    for i in range(10):
        moveForward(turtleList) #Move each turtle in the list forward
        stamp(turtleList)       #Stamp where the turtle stopped

if __name__ == "__main__":
    main()
</code></pre>
        </div>
      </div>

      <p>
        We will fill in each function, one-by-one, using the comments as
        guidance. The first function should welcome the user to the program:
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre class="highlight"><code>def welcomeMessage():
    print()
    print("Welcome to our herd of turtles demonstration!")
    print()
</code></pre>
        </div>
      </div>

      <p>
        Add it to the program above and run it to make sure there are no typos
        or errors.
      </p>

      <p>
        Next, let’s ask the user for the number of turtles. Since the function
        call is on the right hand side of an equals sign, it returns a value
        (namely, the number of turtles) that we will use later in the program.
        So, our function will ask the user for the number and then use a return
        statement to send that value back to the calling function:
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre class="highlight"><code>def getInput():
    n = eval(input("Please enter the number of turtles: "))
    return n
</code></pre>
        </div>
      </div>

      <p>When we add these in, we now have the program:</p>

      <p>#Intro Programming Lab: A program with herd of turtles</p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre class="highlight"><code>import turtle

def welcomeMessage():
    print()
    print("Welcome to our herd of turtles demonstration!")
    print()

def getInput():
    n = eval(input("Please enter the number of turtles: "))
    return n

def main():
    welcomeMessage()            #Writes a welcome message to the shell
    numTurtles = getInput()     #Ask for number of turles
    w = setUpScreen()           #Set up a green turtle window
    turtleList = setUpTurtles(numTurtles) #Make a list of turtles, different colors
    for i in range(10):
        moveForward(turtleList) #Move each turtle in the list forward
        stamp(turtleList)       #Stamp where the turtle stopped

if __name__ == "__main__":
    main()
</code></pre>
        </div>
      </div>

      <p>
        We still need to set up the turtle window and make it green. The turtle
        command to change the background color is bgcolor and colors can be
        referred by their names or the percentage of red, green, and blue
        (‘RGB’) in the color. Let’s use the name to change the window color:
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre class="highlight"><code>def setUpScreen():
    w = turtle.Screen()
    w.bgcolor("green")
    return w
</code></pre>
        </div>
      </div>

      <p>
        Next, we need to set up a list of turtles. From the function invocation
        in the main() we know it has the outline:
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre class="highlight"><code>def setUpTurtles(n):
    #Create a list of turtles
    #Make each turtle appear turtle-shaped
    #Change the color and default direction (so they don't run over each other)
    return tList
</code></pre>
        </div>
      </div>

      <p>
        To set up our list, we will follow our outline from the strings and
        lists chapter:
      </p>

      <ol>
        <li>Create an empty list</li>
        <li>Make a new item</li>
      </ol>

      <p>For our turtles, this looks like:</p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre class="highlight"><code>def setUpTurtles(n):
    tList = []
    #Create turtles:
    for i in range(n):
        t = turtle.Turtle()
        t.shape("turtle")       #Make the turtle appear turtle-shaped
        tList.append(t)

    return tList
</code></pre>
        </div>
      </div>

      <p>
        Lastly for this function, we need to change the color and direction. We
        will use the `red-blue-green’ (`RGB’) values to give each turtle a
        different color. To keep the turtle color from clashing with the green
        background, we will set the red and green parts of the color to 0, and
        just allow the blue to change from 50% to 100%. To spread the turtles
        out, we’ll divide the circle into even angles:
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre class="highlight"><code>def setUpTurtles(n):
    tList = []
    #Create turtles:
    for i in range(n):
        t = turtle.Turtle()
        t.shape("turtle")       #Make the turtle appear turtle-shaped
        tList.append(t)

#Change their color from the blue default and default direction
for i in range(n):
    tList[i].color(0,0,i/(2*n)+.5)
    tList[i].right(i*360/n)
 
return tList
</code></pre>
        </div>
      </div>

      <p>
        If you run your program, you will see the turtles arranged pointing
        outwards from a center point, in different shapes of blue.
      </p>

      <p>
        The next functions of the program are straightforward. We will move each
        turtle forward using a
        <code class="language-plaintext highlighter-rouge">for</code> loop. We
        chose 30 by experimenting with window size. If it does not fit well on
        your screen, change the forward distance to something that does. To make
        a stamp of where the turtle has been, we use the
        <code class="language-plaintext highlighter-rouge">Turtle</code>
        graphics function,
        <code class="language-plaintext highlighter-rouge">stamp()</code>
      </p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre class="highlight"><code>def moveForward(tList):
    for t in tList:
        t.forward(30)

def stamp(tList):
    for t in tList:
        t.stamp()
</code></pre>
        </div>
      </div>

      <p>Putting all the pieces together, we get:</p>

      <div class="language-plaintext highlighter-rouge">
        <div class="highlight">
          <pre
            class="highlight"
          ><code>#Intro Programming Lab:  A program with herd of turtles

import turtle

def welcomeMessage():
    print()
    print("Welcome to our herd of turtles demonstration!")
    print()

def getInput():
    n = eval(input("Please enter the number of turtles: "))
    return n

def setUpScreen():
    w = turtle.Screen()
    w.bgcolor("green")
    return w

def setUpTurtles(n):
    tList = []
    #Create turtles:
    for i in range(n):
        t = turtle.Turtle()
        t.shape("turtle")       #Make the turtle appear turtle-shaped
        tList.append(t)

    #Change their color from the blue default and default direction
    for i in range(n):
        tList[i].color(0,0,i/(2*n)+.5)
        tList[i].right(i*360/n)

    return tList

def moveForward(tList):
    for t in tList:
        t.forward(30)

def stamp(tList):
    for t in tList:
        t.stamp()

def main():
    welcomeMessage()            #Writes a welcome message to the shell
    numTurtles = getInput()     #Ask for number of turles
    w = setUpScreen()           #Set up a green turtle window
    turtleList = setUpTurtles(numTurtles) #Make a list of turtles, different colors
    for i in range(10):
        moveForward(turtleList) #Move each turtle in the list forward
        stamp(turtleList)       #Stamp where the turtle stopped

if __name__ == "__main__":
    main()
</code></pre>
        </div>
      </div>

      <p>
        Try running your program. What happens? How could you modify it to make
        green turtles on a blue background? What would you need to modify to
        make the turtles make a circle each time?
      </p>

      <h3 id="github">github</h3>

      <p>
        <a href="https://github.com"><img src="images/Octocat.png" alt="" /></a
        ><br />
        <a href="https://github.com">github</a> is the standard way to share and
        collaborate on code. It functions much as Google docs does for
        documents. We will use it as a place (<strong>repository</strong> or
        “repo”) for programs and lab exercises.
      </p>

      <ol>
        <li>
          If you do not already have an account, create an account on
          <a href="https://github.com">github</a>. github will be used in future
          classes (and by employers), so, choose an account name that you can
          use for years to come.
        </li>
        <li>
          Work through the
          <a
            href="http://readwrite.com/2013/09/30/understanding-github-a-journey-for-beginners-part-1"
            >github for beginners</a
          >
          tutorial.
        </li>
        <li>
          Work through the
          <a href="https://guides.github.com/activities/hello-world/"
            >github Hello World</a
          >
          tutorial.
        </li>
      </ol>

      <p>
        From Program #35 onward, all sample programs are available at the class
        repository (repo):
      </p>

      <blockquote>
        <p>
          <a href="https://github.com/mmakki11/csci127"
            >https://github.com/mmakki11/csci127</a
          >
        </p>
      </blockquote>

      <p>
        You can access programs by going to the website
      </p>

      <h3 id="whats-next">What’s Next?</h3>

      <p>
        If you finish the lab early, now is a great time to get a head start on
        the programming problems due early next week. There’s instructors to
        help you, and you already have Python up and running. The
        <a href="assignments.html">Programming Problem List</a> has problem
        descriptions, suggested reading, and due dates next to each problem.
      </p>
    </div>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js"
      integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg="
      crossorigin="anonymous"
    ></script>
    <script>
      anchors.add();
    </script>
  </body>
</html>
